<div class="main-container">
    <div mat-dialog-title>
        Aggiungi nuovo socio
    </div>
    <ng-container *ngIf="loading.isLoaded()">
        <ng-container *ngIf="!error">
            <form #form="ngForm">
                <div mat-dialog-content fxLayout="column" fxLayoutGap.lt-md="1em">
                    <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap.lt-md="1em">
                        <div fxFlex="50%" fxLayout="row" fxLayoutAlign="start center" fxLayoutGap="0.5em">
                            <label fxFlex="20%" for="numero">Numero Tessera:</label>
                            <mat-form-field fxFlex="50%">
                                <input type="text" name="numero" [(ngModel)]="model.tessere[0].numero" [notInArray]="tessAttivo.tessere" #inputNumero="ngModel"
                                    matInput required [pattern]="PATTERN_NUMERO_TESSERA">
                                <mat-error *ngIf="inputNumero.errors && inputNumero.errors.required">
                                    Il campo è obbligatorio!
                                </mat-error>
                                <mat-error *ngIf="inputNumero.errors && inputNumero.errors.pattern">
                                    Devi inserire un numero (anche negativo).
                                </mat-error>
                                <mat-error *ngIf="inputNumero.errors && inputNumero.errors.notInArray">
                                    La tessera è già assegnata!.
                                </mat-error>
                                <mat-hint *ngIf="inputNumero.untouched || !inputNumero.value">
                                    Devi inserire un numero (anche negativo).
                                </mat-hint>
                            </mat-form-field>
                        </div>
                        <div fxFlex="50%" fxLayout="row" fxLayoutAlign="start center" fxLayoutGap="0.5em">
                            <label fxFlex="20%" for="anno"> Anno:</label>
                            <p> {{ model.tessere[0].anno }} </p>
                        </div>
                    </div>

                    <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap.lt-md="1em">
                        <div fxFlex="50%" fxLayout="row" fxLayoutAlign="start center" fxLayoutGap="0.5em">
                            <label fxFlex="20%" for="nome">Nome:</label>
                            <mat-form-field fxFlex="50%">
                                <input type="text" name="nome" [(ngModel)]="model.nome" matInput required #inputNome="ngModel" />
                                <mat-error *ngIf="inputNome.errors && inputNome.errors.required">
                                    Il campo è obbligatorio!
                                </mat-error>
                            </mat-form-field>
                        </div>
                        <div fxFlex="50%" fxLayout="row" fxLayoutAlign="start center" fxLayoutGap="0.5em">
                            <label fxFlex="20%" for="cognome">Cognome:</label>
                            <mat-form-field fxFlex="50%">
                                <input type="text" name="cognome" [(ngModel)]="model.cognome" matInput required #inputCognome="ngModel" />
                                <mat-error *ngIf="inputCognome.errors && inputCognome.errors.required">
                                    Il campo è obbligatorio!
                                </mat-error>
                            </mat-form-field>
                        </div>
                    </div>

                    <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap.lt-md="1em">
                        <div fxFlex="50%" fxLayout="row" fxLayoutAlign="start center" fxLayoutGap="0.5em">
                            <label fxFlex="20%" for="email">E-Mail:</label>
                            <mat-form-field fxFlex="50%">
                                <input type="text" name="email" [(ngModel)]="model.email" matInput required email #inputEmail="ngModel" />
                                <mat-error *ngIf="inputEmail.errors && inputEmail.errors.required">
                                    Il campo è obbligatorio!
                                </mat-error>
                                <mat-error *ngIf="inputEmail.errors && inputEmail.errors.email && !inputEmail.errors.required">
                                    Non è una email valida!
                                </mat-error>
                            </mat-form-field>
                        </div>
                        <div fxFlex="50%" fxLayout="row" fxLayoutAlign="start center" fxLayoutGap="0.5em">
                            <label fxFlex="20%" for="cellulare">Cellulare:</label>
                            <mat-form-field fxFlex="50%">
                                <input type="text" name="cellulare" [(ngModel)]="model.cellulare" matInput [pattern]="PATTERN_CELLULARE" #inputCell="ngModel"
                                />
                                <mat-error *ngIf="inputCell.errors && inputCell.errors.pattern">
                                    Non corrisponde al formato previsto
                                </mat-error>
                                <mat-hint *ngIf="inputCell.untouched || !inputCell.value">
                                    10 cifre con, eventualmente, il prefisso internazionale.
                                </mat-hint>
                            </mat-form-field>
                        </div>
                    </div>

                    <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap.lt-md="1em">
                        <div fxFlex="50%" fxLayout="row" fxLayoutAlign="start center" fxLayoutGap="0.5em">
                            <label fxFlex="20%" for="facebook">Facebook:</label>
                            <mat-form-field fxFlex="50%">
                                <input type="text" name="facebook" [(ngModel)]="model.facebook" matInput/>
                            </mat-form-field>
                        </div>
                        <div fxFlex="50%" fxLayout="row" fxLayoutAlign="start center" fxLayoutGap="0.5em">
                            <label fxFlex="20%" for="studente">Studente:</label>
                            <mat-slide-toggle fxFlex="50%" [(ngModel)]="model.carriere[0].studente" name="studente" color="primary">
                            </mat-slide-toggle>
                        </div>
                    </div>

                    <ng-container *ngIf="model.carriere[0].studente">
                        <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap.lt-md="1em">
                            <div fxFlex="50%" fxLayout="row" fxLayoutAlign="start center" fxLayoutGap="0.5em">

                                <label fxFlex="20%" for="matricola">Matricola:</label>
                                <mat-form-field fxFlex="50%">
                                    <input type="text" name="matricola" [(ngModel)]="model.carriere[0].matricola" matInput [required]="model.carriere[0].studente"
                                        [pattern]="PATTERN_MATRICOLA" #inputMatricola="ngModel" />
                                    <mat-error *ngIf="inputMatricola.errors && inputMatricola.errors.required">
                                        Il campo è obbligatorio!
                                    </mat-error>
                                    <mat-error *ngIf="inputMatricola.errors && inputMatricola.errors.pattern">
                                        La matricola è di 10 cifre, di cui lo zero iniziale può essere omesso.
                                    </mat-error>
                                    <mat-hint *ngIf="inputMatricola.untouched || !inputMatricola.value">
                                        La matricola è di 10 cifre, di cui lo zero iniziale può essere omesso.
                                    </mat-hint>
                                </mat-form-field>
                            </div>
                            <div fxFlex="50%" fxLayout="row" fxLayoutAlign="start center" fxLayoutGap="0.5em">
                                <label fxFlex="20%" for="corso">Corso di laurea:</label>
                                <div class="mat-form-field" fxFlex="50%">
                                    <corsi-viewedit [(ngModel)]="model.carriere[0].corso" [flag]="true" [required]="model.carriere[0].studente" name="corso"></corsi-viewedit>
                                </div>
                            </div>
                        </div>
                    </ng-container>

                    <ng-container *ngIf="!model.carriere[0].studente">
                        <div fxLayout="row" fxLayout.lt-md="column" fxLayoutGap.lt-md="1em">
                            <div fxFlex="50%" fxLayout="row" fxLayoutAlign="start center" fxLayoutGap="0.5em">
                                <label fxFlex="20%" for="professione">Professione:</label>
                                <mat-form-field fxFlex="50%">
                                    <input type="text" name="professione" [(ngModel)]="model.carriere[0].professione" matInput [required]="!model.carriere[0].studente"
                                        #inputProfessione="ngModel" />
                                    <mat-error *ngIf="inputProfessione.errors && inputProfessione.errors.required">
                                        Il campo è obbligatorio!
                                    </mat-error>
                                </mat-form-field>
                            </div>
                        </div>
                    </ng-container>
                </div>
                <div mat-dialog-actions style="display: block">
                    <button type="submit" class="to_right" mat-icon-button (click)="submitForm(form)" [disabled]="form.invalid">
                <mat-icon matTooltip="Conferma" matTooltipPosition="right">check</mat-icon>
            </button>
                    <button class="to_right" mat-dialog-close mat-icon-button (click)="revertForm(form)">
                <mat-icon matTooltip="Annulla" matTooltipPosition="right">close</mat-icon>
            </button>
                </div>
            </form>
        </ng-container>
        <ng-container *ngIf="error">
            <div mg-dialog-content>
                <h3>Nessun Tesseramento attivo!</h3>
            </div>
        </ng-container>
    </ng-container>
    <ng-container *ngIf="!loading.isLoaded()">
        <loading-placeholder></loading-placeholder>
    </ng-container>
</div>