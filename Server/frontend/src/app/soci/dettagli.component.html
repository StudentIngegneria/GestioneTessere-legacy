<div md-dialog-title style="text-align:center">
    <button class="to_left" md-icon-button (click)="exit()">
        <md-icon mdTooltip="Esci" mdTooltipPosition="right">keyboard_arrow_left</md-icon>
    </button>
    <h3>
        Modifica dati {{model.nome}}
    </h3>
</div>
<form #form="ngForm" [ngClass]="form_style">
    <div md-dialog-content>
        <div class="form_group">
            <span class="label">Nome:</span>
            <text-viewedit [(ngModel)]="model.nome" name="nome" [flag]="editing" required></text-viewedit>
        </div>
        <div class="form_group">
            <span class="label">Cognome:</span>
            <text-viewedit [(ngModel)]="model.cognome" name="cognome" [flag]="editing" required></text-viewedit>
        </div>
        <div class="form_group">
            <span class="label">E-Mail:</span>
            <text-viewedit [(ngModel)]="model.email" name="email" [flag]="editing" required></text-viewedit>
        </div>
        <div class="form_group">
            <span class="label">Cellulare:</span>
            <text-viewedit [(ngModel)]="model.cellulare" name="cellulare" [flag]="editing" required></text-viewedit>
        </div>
        <div class="form_group">
            <span class="label">Facebook:</span>
            <text-viewedit [(ngModel)]="model.facebook" name="facebook" [flag]="editing" required></text-viewedit>
        </div>
        <div class="table-container">
            <div class="label">
                Carriere: <br />
                <button md-icon-button *ngIf="editing" (click)="addCarriera()">
                    <md-icon mdTooltip="Nuova carriera" mdTooltipPosition="left">add</md-icon>
                </button>
            </div>
            <md-table [dataSource]="carriereSource">

                <ng-container cdkColumnDef="studente">
                    <md-header-cell *cdkHeaderCellDef> Studente/Lavoratore </md-header-cell>
                    <md-cell *cdkCellDef="let row; let ind=index">
                        {{row.studente ? 'Studente' : 'Lavoratore'}}
                    </md-cell>
                </ng-container>

                <ng-container cdkColumnDef="dettagli">
                    <md-header-cell *cdkHeaderCellDef> Corso di laurea/ Professione </md-header-cell>
                    <md-cell *cdkCellDef="let row; let ind = index">
                        <ng-container *ngIf="!carriereEditing[ind]">
                            {{row}}
                        </ng-container>
                        <ng-container *ngIf="carriereEditing[ind]">
                            <ng-container *ngIf="row.studente">
                                <corsi-viewedit [(ngModel)]="row.corso" [flag]="true" required name="corso"></corsi-viewedit>
                            </ng-container>
                            <md-input-container *ngIf="!row.studente">
                                <input type="text" [(ngModel)]="row.professione" name="professione" mdInput required />
                            </md-input-container>
                        </ng-container>
                    </md-cell>
                </ng-container>

                <ng-container cdkColumnDef="azioni">
                    <md-header-cell *cdkHeaderCellDef> Azioni </md-header-cell>
                    <md-cell *cdkCellDef="let row; let ind=index">
                        <button md-icon-button (click)="carriereEditing[ind] = !carriereEditing[ind]">
                            <md-icon mdTooltip="Modifica" mdTooltipPosition="right">edit</md-icon>
                        </button>
                    </md-cell>
                </ng-container>

                <md-header-row *cdkHeaderRowDef="carriereColumns"></md-header-row>
                <md-row *cdkRowDef="let row; columns: carriereColumns;"></md-row>

            </md-table>
        </div>
        <div class="table-container">
            <span class="label">Tessere:</span>
            <md-table [dataSource]="tessereSource">

                <ng-container cdkColumnDef="numero">
                    <md-header-cell *cdkHeaderCellDef> Numero </md-header-cell>
                    <md-cell *cdkCellDef="let row"> {{row.numero}} </md-cell>
                </ng-container>

                <ng-container cdkColumnDef="anno">
                    <md-header-cell *cdkHeaderCellDef> Anno </md-header-cell>
                    <md-cell *cdkCellDef="let row"> {{row.anno}} </md-cell>
                </ng-container>

                <md-header-row *cdkHeaderRowDef="tessereColumns"></md-header-row>
                <md-row *cdkRowDef="let row; columns: tessereColumns;"></md-row>
            </md-table>
        </div>
    </div>
    <div md-dialog-actions style="display: block">
        <ng-container *ngIf="editing">
            <button class="to_right" md-icon-button (click)="confirm(form)" [disabled]="form.invalid">
                <md-icon mdTooltip="Conferma" mdTooltipPosition="above">done</md-icon>
            </button>
            <button class="to_right" md-icon-button (click)="revert(form)">
                <md-icon mdTooltip="Annulla" mdTooltipPosition="above">close</md-icon>
            </button>
        </ng-container>
        <ng-container *ngIf="!editing">
            <button class="to_right" md-icon-button (click)="enableEditing()">
                <md-icon mdTooltip="Modifica" mdTooltipPosition="above">edit</md-icon>
            </button>
        </ng-container>
    </div>
</form>